===============
total number of tokens in the current prompt:541

Generated query:

SELECT s.station_name, l.line_name, MAX((CAST(SUM(rr.average_flow) AS REAL) - (SUM(rr.average_ons) + SUM(rr.average_offs))) / CAST(SUM(rr.average_flow) AS REAL)) AS maximally_bypassed_ratio
FROM rail_ridership rr
JOIN stations s ON rr.station_id = s.station_id
JOIN lines l ON rr.line_id = l.line_id
WHERE rr.season = 'Fall 2019'
GROUP BY l.line_name, s.station_name
ORDER BY l.line_name;


===============
total number of tokens in the current prompt:541

Generated query:

SELECT s.station_name, l.line_name, 
       MAX((CAST(SUM(rr.average_flow) AS REAL) - (SUM(rr.average_ons) + SUM(rr.average_offs))) / CAST(SUM(rr.average_flow) AS REAL)) as bypassed_ratio
FROM rail_ridership rr
JOIN stations s ON rr.station_id = s.station_id
JOIN lines l ON rr.line_id = l.line_id
WHERE rr.season = 'Fall 2019'
GROUP BY l.line_name, s.station_name
ORDER BY l.line_name;


===============
total number of tokens in the current prompt:541

Generated query:

SELECT 
  stations.station_name,
  lines.line_name,
  MAX((CAST((SUM(rail_ridership.average_flow) - (SUM(rail_ridership.average_ons) + SUM(rail_ridership.average_offs))) AS REAL))/CAST(SUM(rail_ridership.average_flow) AS REAL)) AS bypassed_ratio
FROM 
  rail_ridership 
JOIN 
  stations ON rail_ridership.station_id = stations.station_id
JOIN 
  lines ON rail_ridership.line_id = lines.line_id
WHERE 
  rail_ridership.season = 'Fall 2019'
GROUP BY 
  lines.line_name, stations.station_name
ORDER BY 
  lines.line_name ASC;


===============
total number of tokens in the current prompt:541

Generated query:

SELECT s.station_name, l.line_name, 
       CAST(MAX((CAST(SUM(rr.average_flow) AS REAL) - SUM(rr.average_ons) - SUM(rr.average_offs)) / CAST(SUM(rr.average_flow) AS REAL)) AS REAL) AS bypassed_ratio
FROM routes r
JOIN stations s ON r.first_station_id = s.station_id
JOIN lines l ON r.line_id = l.line_id
JOIN station_orders so ON r.route_id = so.route_id
JOIN rail_ridership rr ON (r.line_id = rr.line_id AND r.direction = rr.direction AND s.station_id = rr.station_id)
WHERE rr.season = 'Fall 2019'
GROUP BY l.line_id, s.station_id
ORDER BY l.line_name;


===============
total number of tokens in the current prompt:541

Generated query:

SELECT s.station_name, l.line_name, 
  CAST(MAX((SUM(rr.average_flow) - (SUM(rr.average_ons) + SUM(rr.average_offs))) / SUM(rr.average_flow)) AS REAL) AS bypassed_ratio
FROM stations s
JOIN station_orders so ON s.station_id = so.station_id
JOIN routes r ON r.route_id = so.route_id
JOIN lines l ON l.line_id = r.line_id
JOIN rail_ridership rr ON rr.line_id = l.line_id AND rr.station_id = s.station_id
WHERE rr.season = 'Fall 2019'
GROUP BY l.line_name, s.station_name
ORDER BY l.line_name;


error running sql query: misuse of aggregate function SUM()
===============
total number of tokens in the current prompt:541

Generated query:

SELECT s.station_name, l.line_name, 
    CAST(MAX((SUM(rr.average_flow) - (SUM(rr.average_ons) + SUM(rr.average_offs))) / SUM(rr.average_flow)) AS REAL) AS bypassed_ratio
FROM stations s
JOIN station_orders so ON s.station_id = so.station_id
JOIN routes r ON so.route_id = r.route_id
JOIN lines l ON r.line_id = l.line_id
JOIN rail_ridership rr ON r.line_id = rr.line_id AND so.station_id = rr.station_id
WHERE rr.season = 'Fall 2019'
GROUP BY l.line_name, s.station_name
ORDER BY l.line_name;


error running sql query: misuse of aggregate function SUM()
