===============
total number of tokens in the current prompt:438

Generated query:

WITH max_total_offs AS (
  SELECT MAX(total_offs) AS max_total_offs 
  FROM rail_ridership
)
SELECT t.day_type, 
       t.period_start_time, 
       r.season, 
       r.line_id, 
       s.station_name, 
       r.total_offs
FROM rail_ridership r
JOIN stations s ON r.station_id = s.station_id
JOIN time_periods t ON r.time_period_id = t.time_period_id
WHERE r.total_offs = (SELECT * FROM max_total_offs)


Accuracy of test results (length 1) vs target results (length 1) is 1.0

time taken: 1.8651258945465088 seconds
===============
total number of tokens in the current prompt:438

Generated query:

WITH total_offs_per_station AS (
  SELECT 
    rr.station_id,
    rr.time_period_id,
    rr.season,
    rr.line_id,
    s.station_name,
    SUM(rr.total_offs) AS total_offs
  FROM rail_ridership rr
  JOIN stations s ON rr.station_id = s.station_id
  GROUP BY rr.station_id, rr.time_period_id, rr.season, rr.line_id, s.station_name
)
SELECT 
  tp.day_type,
  tp.period_start_time,
  tops.season,
  tops.line_id,
  tops.station_name,
  tops.total_offs
FROM total_offs_per_station tops
JOIN time_periods tp ON tops.time_period_id = tp.time_period_id
WHERE tops.total_offs = (SELECT MAX(total_offs) FROM total_offs_per_station)


Accuracy of test results (length 1) vs target results (length 1) is -1.0

time taken: 3.4089670181274414 seconds
===============
total number of tokens in the current prompt:438

Generated query:

WITH total_offs_by_station AS (
  SELECT
    station_id,
    line_id,
    season,
    day_type,
    time_period_id,
    SUM(total_offs) AS total_offs
  FROM rail_ridership
  GROUP BY station_id, line_id, season, day_type, time_period_id
)
SELECT
  t.day_type,
  tp.period_start_time,
  t.season,
  t.line_id,
  s.station_name,
  t.total_offs
FROM total_offs_by_station t
JOIN stations s ON t.station_id = s.station_id
JOIN time_periods tp ON t.time_period_id = tp.time_period_id
WHERE total_offs = (SELECT MAX(total_offs) FROM total_offs_by_station)
LIMIT 1;


error running sql query: no such column: day_type
