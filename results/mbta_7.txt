===============
total number of tokens in the current prompt:405

Generated query:

SELECT s.station_name, r.total_ons
FROM stations s
JOIN rail_ridership r ON s.station_id = r.station_id
JOIN time_periods t ON r.time_period_id = t.time_period_id
WHERE r.line_id = 'Orange Line'
AND r.season = 'Fall 2018'
AND t.time_period_id = '01'
AND r.direction = 0
AND r.total_ons > 
    (SELECT AVG(total_ons) 
     FROM rail_ridership 
     WHERE line_id = 'Orange Line' 
     AND season = 'Fall 2018' 
     AND time_period_id = '01' 
     AND direction = 0)
ORDER BY r.total_ons DESC, s.station_name ASC;


Accuracy of test results (length 0) vs target results (length 5) is 0.0

time taken: 2.547207832336426 seconds
===============
total number of tokens in the current prompt:405

Generated query:

SELECT s.station_name, r.total_ons
FROM stations s
JOIN rail_ridership r ON s.station_id = r.station_id
WHERE r.line_id = 'Orange' 
AND r.season = 'Fall 2018' 
AND r.time_period_id = '01' 
AND r.direction = 0 
AND r.total_ons > (
    SELECT AVG(total_ons)
    FROM rail_ridership
    WHERE line_id = 'Orange' 
    AND season = 'Fall 2018' 
    AND time_period_id = '01' 
    AND direction = 0
)
ORDER BY r.total_ons DESC, s.station_name ASC;


Accuracy of test results (length 0) vs target results (length 5) is 0.0

time taken: 2.2323238849639893 seconds
===============
total number of tokens in the current prompt:405

Generated query:

WITH orange_line_avg_ons AS (
  SELECT season, line_id, direction, time_period_id, AVG(average_ons) AS avg_ons
  FROM rail_ridership
  WHERE season = 'Fall 2018' AND line_id = 'Orange Line'
  GROUP BY season, line_id, direction, time_period_id
)
SELECT s.station_name, r.total_ons
FROM stations s
JOIN rail_ridership r ON s.station_id = r.station_id
JOIN time_periods tp ON r.time_period_id = tp.time_period_id
JOIN orange_line_avg_ons o ON r.season = o.season AND r.line_id = o.line_id AND r.direction = o.direction AND r.time_period_id = o.time_period_id
WHERE r.season = 'Fall 2018' AND r.line_id = 'Orange Line' AND r.direction = 0 AND r.time_period_id = '01' AND r.total_ons > o.avg_ons
ORDER BY r.total_ons DESC, s.station_name


Accuracy of test results (length 0) vs target results (length 5) is 0.0

time taken: 3.892648935317993 seconds
